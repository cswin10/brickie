(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{3966:function(e,t,s){Promise.resolve().then(s.bind(s,1728))},1728:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var a=s(6517),n=s(6557),r=s(6815),i=s(9438);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let c=(0,s(5802).Z)("PoundSterling",[["path",{d:"M18 7c0-5.333-8-5.333-8 0",key:"1prm2n"}],["path",{d:"M10 7v14",key:"18tmcs"}],["path",{d:"M6 21h12",key:"4dkmi1"}],["path",{d:"M6 13h10",key:"ybwr4a"}]]);var o=s(1052),l=s(9843),d=s(2338),m=s(9781),u=s(9115),x=s(9250),p=s(1184),h=s(9378),b=s(4988);function f(){var e,t;let s=(0,r.useParams)(),f=(0,r.useRouter)(),{user:w,profile:j,removeJob:g}=(0,p.o)(),[N,y]=(0,n.useState)(null),[v,_]=(0,n.useState)(!0),[T,k]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{if(!w||!s.id)return;let e=(0,x.e)();y(await (0,h.Zn)(e,s.id,w.id)),_(!1)})()},[w,s.id]);let S=async()=>{if(!w||!N||!confirm("Are you sure you want to delete this job?"))return;let e=(0,x.e)();await (0,h.CC)(e,N.id,w.id)&&(g(N.id),f.push("/dashboard/jobs"))},z=async()=>{if(N&&j){k(!0);try{await (0,b.b)({id:N.id,timestamp:new Date(N.created_at).getTime(),inputs:N.inputs,outputs:N.outputs,photoUri:N.photo_url||""},{companyName:j.company_name||"",defaultDayRate:j.day_rate||220,defaultPricingMethod:"day_rate",defaultRatePer1000:500,defaultRatePerM2:65,materialMarkup:10,vatRegistered:!1,vatRate:20,currency:"GBP",disclaimerText:j.disclaimer_text||""})}catch(e){console.error("Failed to generate PDF:",e)}finally{k(!1)}}};return v?(0,a.jsx)(u.wY,{}):N?(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("button",{onClick:()=>f.push("/dashboard/jobs"),className:"flex items-center text-warm-600 hover:text-warm-900 mb-6",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"Back to Jobs"]}),(0,a.jsxs)("div",{className:"space-y-6",children:[N.photo_url&&(0,a.jsx)("img",{src:N.photo_url,alt:"Job photo",className:"w-full h-64 object-cover rounded-xl"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-warm-900",children:N.inputs.jobType}),(0,a.jsx)("p",{className:"text-sm text-warm-500",children:new Date(N.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,a.jsxs)("p",{className:"text-warm-600 mt-1",children:[N.inputs.anchorType,": ",N.inputs.anchorValue,"m •"," ",N.inputs.difficulty,N.inputs.hasOpenings?" • Has openings":""]})]}),(0,a.jsxs)("div",{className:"bg-brick-500 rounded-2xl p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(c,{className:"w-5 h-5 opacity-80"}),(0,a.jsx)("span",{className:"text-sm font-medium opacity-80",children:"ESTIMATED PRICE"})]}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:(0,h.NO)(N.outputs.recommended_price_gbp_range)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(u.Zb,{className:"bg-warm-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 text-warm-600"}),(0,a.jsx)("span",{className:"text-xs font-medium text-warm-600 uppercase",children:"Labour"})]}),(0,a.jsx)("p",{className:"text-lg font-semibold text-warm-900",children:(0,h.yS)(N.outputs.labour_hours_range)})]}),(0,a.jsxs)(u.Zb,{className:"bg-warm-100",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-warm-600 uppercase",children:"Area"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-warm-900",children:[N.outputs.area_m2.toFixed(1)," m\xb2"]})]})]}),(0,a.jsx)(u.Zb,{title:"Materials",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-warm-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 text-brick-500"}),(0,a.jsx)("span",{className:"text-warm-700",children:"Bricks"})]}),(0,a.jsx)("span",{className:"font-semibold text-warm-900",children:(0,h.nS)(N.outputs.brick_count_range)})]}),(0,a.jsxs)("div",{className:"flex justify-between py-2 border-b border-warm-200",children:[(0,a.jsx)("span",{className:"text-warm-700",children:"Sand"}),(0,a.jsxs)("span",{className:"font-semibold text-warm-900",children:[(0,h.nS)(N.outputs.materials.sand_kg_range)," kg"]})]}),(0,a.jsxs)("div",{className:"flex justify-between py-2",children:[(0,a.jsx)("span",{className:"text-warm-700",children:"Cement"}),(0,a.jsxs)("span",{className:"font-semibold text-warm-900",children:[(0,h.nS)(N.outputs.materials.cement_bags_range)," bags"]})]})]})}),(null===(e=N.outputs.assumptions)||void 0===e?void 0:e.length)>0&&(0,a.jsx)(u.Zb,{title:"Assumptions",children:(0,a.jsx)("ul",{className:"space-y-2",children:N.outputs.assumptions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-brick-500 rounded-full mt-2"}),(0,a.jsx)("span",{className:"text-warm-700",children:e})]},t))})}),(null===(t=N.outputs.exclusions)||void 0===t?void 0:t.length)>0&&(0,a.jsx)(u.Zb,{title:"Exclusions",children:(0,a.jsx)("ul",{className:"space-y-2",children:N.outputs.exclusions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-yellow-500 rounded-full mt-2"}),(0,a.jsx)("span",{className:"text-warm-700",children:e})]},t))})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(u.zx,{variant:"outline",fullWidth:!0,onClick:z,loading:T,children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),"Generate PDF"]}),(0,a.jsxs)(u.zx,{variant:"ghost",fullWidth:!0,onClick:S,children:[(0,a.jsx)(m.Z,{className:"w-5 h-5 mr-2"}),"Delete Job"]})]})]})]}):(0,a.jsxs)("div",{className:"max-w-2xl mx-auto text-center py-12",children:[(0,a.jsx)("p",{className:"text-warm-600 mb-4",children:"Job not found"}),(0,a.jsx)(u.zx,{onClick:()=>f.push("/dashboard/jobs"),children:"Back to Jobs"})]})}},4988:function(e,t,s){"use strict";s.d(t,{b:function(){return r}});var a=s(2693),n=s(9378);async function r(e,t){var s,r;let i=await a.PDFDocument.create(),c=i.addPage([595,842]),{height:o}=c.getSize(),l=await i.embedFont(a.StandardFonts.Helvetica),d=await i.embedFont(a.StandardFonts.HelveticaBold),m=o-50,u=(0,a.rgb)(.2,.2,.2),x=(0,a.rgb)(.4,.4,.4),p=(0,a.rgb)(.73,.27,.17);c.drawText("BRICKIE ESTIMATE",{x:50,y:m,size:24,font:d,color:p}),m-=30,t.companyName&&(c.drawText(t.companyName,{x:50,y:m,size:14,font:d,color:u}),m-=18);let h=new Date(e.timestamp).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});for(let t of(c.drawText("Date: ".concat(h),{x:50,y:m,size:10,font:l,color:x}),m-=25,c.drawText("JOB DETAILS",{x:50,y:m,size:12,font:d,color:u}),m-=18,["Job Type: ".concat(e.inputs.jobType),"Anchor Dimension: ".concat(e.inputs.anchorType," = ").concat(e.inputs.anchorValue,"m"),"Difficulty: ".concat(e.inputs.difficulty),"Has Openings: ".concat(e.inputs.hasOpenings?"Yes":"No"),"Estimated Area: ".concat(e.outputs.area_m2.toFixed(1)," m\xb2")]))c.drawText(t,{x:50,y:m,size:10,font:l,color:u}),m-=18;for(let t of(m-=7,c.drawText("ESTIMATED PRICE",{x:50,y:m,size:12,font:d,color:u}),m-=23,c.drawText((0,n.NO)(e.outputs.recommended_price_gbp_range),{x:50,y:m,size:20,font:d,color:p}),m-=25,c.drawText("LABOUR & MATERIALS",{x:50,y:m,size:12,font:d,color:u}),m-=18,["Labour: ".concat((0,n.yS)(e.outputs.labour_hours_range)),"Bricks: ".concat((0,n.nS)(e.outputs.brick_count_range)),"Sand: ".concat((0,n.nS)(e.outputs.materials.sand_kg_range)," kg"),"Cement: ".concat((0,n.nS)(e.outputs.materials.cement_bags_range)," bags")]))c.drawText(t,{x:50,y:m,size:10,font:l,color:u}),m-=18;if(m-=7,(null===(s=e.outputs.assumptions)||void 0===s?void 0:s.length)>0){for(let t of(c.drawText("ASSUMPTIONS",{x:50,y:m,size:12,font:d,color:u}),m-=18,e.outputs.assumptions)){let e="• ".concat(t).substring(0,80);c.drawText(e,{x:50,y:m,size:9,font:l,color:x}),m-=15}m-=7}if((null===(r=e.outputs.exclusions)||void 0===r?void 0:r.length)>0){for(let t of(c.drawText("EXCLUSIONS",{x:50,y:m,size:12,font:d,color:u}),m-=18,e.outputs.exclusions)){let e="• ".concat(t).substring(0,80);c.drawText(e,{x:50,y:m,size:9,font:l,color:x}),m-=15}m-=7}m=Math.max(m,130),c.drawLine({start:{x:50,y:m+10},end:{x:545,y:m+10},thickness:.5,color:(0,a.rgb)(.8,.8,.8)}),m-=10,c.drawText("DISCLAIMER",{x:50,y:m,size:10,font:d,color:x}),m-=15;let b=t.disclaimerText.split(" "),f="";for(let e of b){let t=f+(f?" ":"")+e;l.widthOfTextAtSize(t,8)>495?(c.drawText(f,{x:50,y:m,size:8,font:l,color:x}),m-=12,f=e):f=t}f&&c.drawText(f,{x:50,y:m,size:8,font:l,color:x}),c.drawText("Generated by Brickie App",{x:50,y:40,size:8,font:l,color:(0,a.rgb)(.6,.6,.6)});let w=new Blob([await i.save()],{type:"application/pdf"}),j=URL.createObjectURL(w),g=document.createElement("a");g.href=j,g.download="brickie-estimate-".concat(e.id,".pdf"),document.body.appendChild(g),g.click(),document.body.removeChild(g),URL.revokeObjectURL(j)}}},function(e){e.O(0,[59,247,997,378,666,416,963,744],function(){return e(e.s=3966)}),_N_E=e.O()}]);
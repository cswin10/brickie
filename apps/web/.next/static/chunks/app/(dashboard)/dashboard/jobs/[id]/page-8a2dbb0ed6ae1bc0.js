(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[450],{3966:function(e,t,s){Promise.resolve().then(s.bind(s,2188))},2188:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return b}});var a=s(6517),n=s(6557),r=s(6815);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let o=(0,s(5802).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);var i=s(104),l=s(1052),c=s(9843),d=s(2338),u=s(9781),m=s(9115),x=s(9250),p=s(1184),h=s(9378),f=s(4988);function b(){var e,t;let s=(0,r.useParams)(),b=(0,r.useRouter)(),{user:w,profile:j,removeJob:y}=(0,p.o)(),[g,N]=(0,n.useState)(null),[v,T]=(0,n.useState)(!0),[_,k]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{if(!w||!s.id)return;let e=(0,x.e)();N(await (0,h.Zn)(e,s.id,w.id)),T(!1)})()},[w,s.id]);let S=async()=>{if(!w||!g||!confirm("Are you sure you want to delete this job?"))return;let e=(0,x.e)();await (0,h.CC)(e,g.id,w.id)&&(y(g.id),b.push("/dashboard/jobs"))},E=async()=>{if(g&&j){k(!0);try{await (0,f.b)({id:g.id,timestamp:new Date(g.created_at).getTime(),inputs:g.inputs,outputs:g.outputs,photoUri:g.photo_url||""},{companyName:j.company_name||"",defaultDayRate:j.day_rate||220,currency:"GBP",disclaimerText:j.disclaimer_text||""})}catch(e){console.error("Failed to generate PDF:",e)}finally{k(!1)}}};return v?(0,a.jsx)(m.wY,{}):g?(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsxs)("button",{onClick:()=>b.push("/dashboard/jobs"),className:"flex items-center text-warm-600 hover:text-warm-900 mb-6",children:[(0,a.jsx)(o,{className:"w-4 h-4 mr-2"}),"Back to Jobs"]}),(0,a.jsxs)("div",{className:"space-y-6",children:[g.photo_url&&(0,a.jsx)("img",{src:g.photo_url,alt:"Job photo",className:"w-full h-64 object-cover rounded-xl"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-warm-900",children:g.inputs.jobType}),(0,a.jsx)("p",{className:"text-sm text-warm-500",children:new Date(g.created_at).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}),(0,a.jsxs)("p",{className:"text-warm-600 mt-1",children:[g.inputs.anchorType,": ",g.inputs.anchorValue,"m •"," ",g.inputs.difficulty,g.inputs.hasOpenings?" • Has openings":""]})]}),(0,a.jsxs)("div",{className:"bg-brick-500 rounded-2xl p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(i.Z,{className:"w-5 h-5 opacity-80"}),(0,a.jsx)("span",{className:"text-sm font-medium opacity-80",children:"ESTIMATED PRICE"})]}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:(0,h.NO)(g.outputs.recommended_price_gbp_range)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(m.Zb,{className:"bg-warm-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 text-warm-600"}),(0,a.jsx)("span",{className:"text-xs font-medium text-warm-600 uppercase",children:"Labour"})]}),(0,a.jsx)("p",{className:"text-lg font-semibold text-warm-900",children:(0,h.yS)(g.outputs.labour_hours_range)})]}),(0,a.jsxs)(m.Zb,{className:"bg-warm-100",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-warm-600 uppercase",children:"Area"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-warm-900",children:[g.outputs.area_m2.toFixed(1)," m\xb2"]})]})]}),(0,a.jsx)(m.Zb,{title:"Materials",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-warm-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 text-brick-500"}),(0,a.jsx)("span",{className:"text-warm-700",children:"Bricks"})]}),(0,a.jsx)("span",{className:"font-semibold text-warm-900",children:(0,h.nS)(g.outputs.brick_count_range)})]}),(0,a.jsxs)("div",{className:"flex justify-between py-2 border-b border-warm-200",children:[(0,a.jsx)("span",{className:"text-warm-700",children:"Sand"}),(0,a.jsxs)("span",{className:"font-semibold text-warm-900",children:[(0,h.nS)(g.outputs.materials.sand_kg_range)," kg"]})]}),(0,a.jsxs)("div",{className:"flex justify-between py-2",children:[(0,a.jsx)("span",{className:"text-warm-700",children:"Cement"}),(0,a.jsxs)("span",{className:"font-semibold text-warm-900",children:[(0,h.nS)(g.outputs.materials.cement_bags_range)," bags"]})]})]})}),(null===(e=g.outputs.assumptions)||void 0===e?void 0:e.length)>0&&(0,a.jsx)(m.Zb,{title:"Assumptions",children:(0,a.jsx)("ul",{className:"space-y-2",children:g.outputs.assumptions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-brick-500 rounded-full mt-2"}),(0,a.jsx)("span",{className:"text-warm-700",children:e})]},t))})}),(null===(t=g.outputs.exclusions)||void 0===t?void 0:t.length)>0&&(0,a.jsx)(m.Zb,{title:"Exclusions",children:(0,a.jsx)("ul",{className:"space-y-2",children:g.outputs.exclusions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-yellow-500 rounded-full mt-2"}),(0,a.jsx)("span",{className:"text-warm-700",children:e})]},t))})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(m.zx,{variant:"outline",fullWidth:!0,onClick:E,loading:_,children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),"Generate PDF"]}),(0,a.jsxs)(m.zx,{variant:"ghost",fullWidth:!0,onClick:S,children:[(0,a.jsx)(u.Z,{className:"w-5 h-5 mr-2"}),"Delete Job"]})]})]})]}):(0,a.jsxs)("div",{className:"max-w-2xl mx-auto text-center py-12",children:[(0,a.jsx)("p",{className:"text-warm-600 mb-4",children:"Job not found"}),(0,a.jsx)(m.zx,{onClick:()=>b.push("/dashboard/jobs"),children:"Back to Jobs"})]})}},4988:function(e,t,s){"use strict";s.d(t,{b:function(){return r}});var a=s(2693),n=s(9378);async function r(e,t){var s,r;let o=await a.PDFDocument.create(),i=o.addPage([595,842]),{height:l}=i.getSize(),c=await o.embedFont(a.StandardFonts.Helvetica),d=await o.embedFont(a.StandardFonts.HelveticaBold),u=l-50,m=(0,a.rgb)(.2,.2,.2),x=(0,a.rgb)(.4,.4,.4),p=(0,a.rgb)(.73,.27,.17);i.drawText("BRICKIE ESTIMATE",{x:50,y:u,size:24,font:d,color:p}),u-=30,t.companyName&&(i.drawText(t.companyName,{x:50,y:u,size:14,font:d,color:m}),u-=18);let h=new Date(e.timestamp).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});for(let t of(i.drawText("Date: ".concat(h),{x:50,y:u,size:10,font:c,color:x}),u-=25,i.drawText("JOB DETAILS",{x:50,y:u,size:12,font:d,color:m}),u-=18,["Job Type: ".concat(e.inputs.jobType),"Anchor Dimension: ".concat(e.inputs.anchorType," = ").concat(e.inputs.anchorValue,"m"),"Difficulty: ".concat(e.inputs.difficulty),"Has Openings: ".concat(e.inputs.hasOpenings?"Yes":"No"),"Estimated Area: ".concat(e.outputs.area_m2.toFixed(1)," m\xb2")]))i.drawText(t,{x:50,y:u,size:10,font:c,color:m}),u-=18;for(let t of(u-=7,i.drawText("ESTIMATED PRICE",{x:50,y:u,size:12,font:d,color:m}),u-=23,i.drawText((0,n.NO)(e.outputs.recommended_price_gbp_range),{x:50,y:u,size:20,font:d,color:p}),u-=25,i.drawText("LABOUR & MATERIALS",{x:50,y:u,size:12,font:d,color:m}),u-=18,["Labour: ".concat((0,n.yS)(e.outputs.labour_hours_range)),"Bricks: ".concat((0,n.nS)(e.outputs.brick_count_range)),"Sand: ".concat((0,n.nS)(e.outputs.materials.sand_kg_range)," kg"),"Cement: ".concat((0,n.nS)(e.outputs.materials.cement_bags_range)," bags")]))i.drawText(t,{x:50,y:u,size:10,font:c,color:m}),u-=18;if(u-=7,(null===(s=e.outputs.assumptions)||void 0===s?void 0:s.length)>0){for(let t of(i.drawText("ASSUMPTIONS",{x:50,y:u,size:12,font:d,color:m}),u-=18,e.outputs.assumptions)){let e="• ".concat(t).substring(0,80);i.drawText(e,{x:50,y:u,size:9,font:c,color:x}),u-=15}u-=7}if((null===(r=e.outputs.exclusions)||void 0===r?void 0:r.length)>0){for(let t of(i.drawText("EXCLUSIONS",{x:50,y:u,size:12,font:d,color:m}),u-=18,e.outputs.exclusions)){let e="• ".concat(t).substring(0,80);i.drawText(e,{x:50,y:u,size:9,font:c,color:x}),u-=15}u-=7}u=Math.max(u,130),i.drawLine({start:{x:50,y:u+10},end:{x:545,y:u+10},thickness:.5,color:(0,a.rgb)(.8,.8,.8)}),u-=10,i.drawText("DISCLAIMER",{x:50,y:u,size:10,font:d,color:x}),u-=15;let f=t.disclaimerText.split(" "),b="";for(let e of f){let t=b+(b?" ":"")+e;c.widthOfTextAtSize(t,8)>495?(i.drawText(b,{x:50,y:u,size:8,font:c,color:x}),u-=12,b=e):b=t}b&&i.drawText(b,{x:50,y:u,size:8,font:c,color:x}),i.drawText("Generated by Brickie App",{x:50,y:40,size:8,font:c,color:(0,a.rgb)(.6,.6,.6)});let w=new Blob([await o.save()],{type:"application/pdf"}),j=URL.createObjectURL(w),y=document.createElement("a");y.href=j,y.download="brickie-estimate-".concat(e.id,".pdf"),document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(j)}},1184:function(e,t,s){"use strict";s.d(t,{o:function(){return a}});let a=(0,s(1447).U)((e,t)=>({user:null,profile:null,isLoading:!0,photoFile:null,photoPreview:null,jobType:"Brickwork",anchorType:"length",anchorValue:"",difficulty:"Standard",hasOpenings:!1,currentResult:null,isEstimating:!1,error:null,jobs:[],setUser:t=>e({user:t}),setProfile:t=>e({profile:t}),setLoading:t=>e({isLoading:t}),setPhotoFile:t=>e({photoFile:t}),setPhotoPreview:t=>e({photoPreview:t}),setJobType:t=>e({jobType:t}),setAnchorType:t=>e({anchorType:t}),setAnchorValue:t=>e({anchorValue:t}),setDifficulty:t=>e({difficulty:t}),setHasOpenings:t=>e({hasOpenings:t}),setCurrentResult:t=>e({currentResult:t}),setEstimating:t=>e({isEstimating:t}),setError:t=>e({error:t}),resetEstimate:()=>e({photoFile:null,photoPreview:null,jobType:"Brickwork",anchorType:"length",anchorValue:"",difficulty:"Standard",hasOpenings:!1,currentResult:null,error:null}),setJobs:t=>e({jobs:t}),addJob:t=>e(e=>({jobs:[t,...e.jobs]})),removeJob:t=>e(e=>({jobs:e.jobs.filter(e=>e.id!==t)})),getInputs:()=>{let{jobType:e,anchorType:s,anchorValue:a,difficulty:n,hasOpenings:r}=t();if(!a)return null;let o=parseFloat(a);return isNaN(o)||o<=0?null:{jobType:e,anchorType:s,anchorValue:o,difficulty:n,hasOpenings:r}}}))},9250:function(e,t,s){"use strict";s.d(t,{e:function(){return r}});var a=s(2059),n=s(8345);function r(){return(0,a.createBrowserClient)(n.env.NEXT_PUBLIC_SUPABASE_URL,n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},9781:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(5802).Z)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])}},function(e){e.O(0,[59,269,200,326,416,963,744],function(){return e(e.s=3966)}),_N_E=e.O()}]);
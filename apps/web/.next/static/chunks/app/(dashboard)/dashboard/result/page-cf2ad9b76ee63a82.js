(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{6125:function(e,t,a){Promise.resolve().then(a.bind(a,7632))},7632:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return y}});var s=a(6517),r=a(6557),l=a(6815),n=a(5802);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let i=(0,n.Z)("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);var c=a(9438),o=a(3488),d=a(1052),m=a(9843);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let x=(0,n.Z)("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);var u=a(2338),h=a(1117),p=a(6435),b=a(1184),f=a(9250),g=a(9378),j=a(4988);function y(){var e,t;let a=(0,l.useRouter)(),[n,y]=(0,r.useState)(!1),[N,v]=(0,r.useState)(!1),[w,k]=(0,r.useState)(!1),{currentResult:_,photoFile:T,photoPreview:S,user:P,profile:M,addJob:A,resetEstimate:R,getInputs:E,getPricingInputs:F}=(0,b.o)(),L=E(),C=F(),z=(0,r.useMemo)(()=>_&&L?(0,g.MI)(_,C,L.jobType):null,[_,C,L]);if(!_||!L||!z)return(0,s.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,s.jsxs)("div",{className:"text-center",children:[(0,s.jsx)("div",{className:"w-16 h-16 mx-auto bg-slate-100 rounded-2xl flex items-center justify-center mb-4",children:(0,s.jsx)(i,{className:"w-8 h-8 text-slate-400"})}),(0,s.jsx)("p",{className:"text-slate-600 mb-4",children:"No estimate results available"}),(0,s.jsx)("button",{onClick:()=>a.push("/dashboard"),className:"btn-gradient text-white px-6 py-3 rounded-xl font-semibold",children:"Start New Estimate"})]})});let I=async()=>{if(P){y(!0);try{let e=(0,f.e)(),t=null;T&&(t=await (0,g.ZH)(e,P.id,T,T.name));let a=await (0,g.Cq)(e,P.id,L,_,t);A(a),k(!0)}catch(e){console.error("Failed to save job:",e)}finally{y(!1)}}},B=async()=>{if(M){v(!0);try{await (0,j.b)({id:"temp-".concat(Date.now()),timestamp:Date.now(),inputs:L,outputs:_,photoUri:S||""},{companyName:M.company_name||"",defaultDayRate:M.day_rate||220,defaultPricingMethod:"day_rate",defaultRatePer1000:500,defaultRatePerM2:65,materialMarkup:10,vatRegistered:!1,vatRate:20,currency:"GBP",disclaimerText:M.disclaimer_text||""})}catch(e){console.error("Failed to generate PDF:",e)}finally{v(!1)}}},D={day_rate:"\xa3".concat(C.dayRate,"/day"),per_1000_bricks:"\xa3".concat(C.ratePer1000,"/1000"),per_m2:"\xa3".concat(C.ratePerM2,"/m\xb2")}[C.method];return(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-b from-slate-50 to-slate-100",children:[(0,s.jsxs)("div",{className:"relative",children:[S?(0,s.jsxs)("div",{className:"relative h-48 sm:h-64",children:[(0,s.jsx)("img",{src:S,alt:"Job",className:"w-full h-full object-cover"}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 via-black/20 to-transparent"})]}):(0,s.jsx)("div",{className:"h-32 bg-gradient-to-r from-brick-600 to-brick-700"}),(0,s.jsx)("button",{onClick:()=>a.back(),className:"absolute top-4 left-4 p-2 bg-black/30 backdrop-blur-sm rounded-full text-white hover:bg-black/50 transition-all",children:(0,s.jsx)(c.Z,{className:"w-5 h-5"})}),(0,s.jsx)("div",{className:"absolute bottom-4 left-4 right-4",children:(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)("span",{className:"px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full text-white text-sm font-medium",children:L.jobType}),(0,s.jsx)("span",{className:"px-3 py-1 bg-white/20 backdrop-blur-sm rounded-full text-white text-sm",children:L.difficulty})]})})]}),(0,s.jsxs)("div",{className:"max-w-lg mx-auto px-4 -mt-6 relative z-10 space-y-4 pb-8",children:[(0,s.jsxs)("div",{className:"card-modern overflow-hidden",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-br from-brick-500 to-brick-700 p-6 text-white",children:[(0,s.jsx)("p",{className:"text-sm font-medium text-brick-100 uppercase tracking-wide mb-2",children:"Your Quote"}),(0,s.jsxs)("p",{className:"text-4xl sm:text-5xl font-bold tracking-tight",children:[(0,g.xG)(z.totalLow)," – ",(0,g.xG)(z.totalHigh)]}),C.includeVAT&&(0,s.jsx)("p",{className:"text-sm text-brick-100 mt-1",children:"inc. VAT"})]}),(0,s.jsxs)("div",{className:"p-4 space-y-3 bg-white",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{className:"text-slate-600",children:["Labour ",(0,s.jsxs)("span",{className:"text-slate-400",children:["(",D,")"]})]}),(0,s.jsxs)("span",{className:"font-medium text-slate-800",children:[(0,g.xG)(z.labourLow)," – ",(0,g.xG)(z.labourHigh)]})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsxs)("span",{className:"text-slate-600",children:["Materials ",(0,s.jsxs)("span",{className:"text-slate-400",children:["(+",C.materialMarkup,"%)"]})]}),(0,s.jsxs)("span",{className:"font-medium text-slate-800",children:[(0,g.xG)(z.materialsLow)," – ",(0,g.xG)(z.materialsHigh)]})]}),C.includeVAT&&(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-slate-600",children:"VAT (20%)"}),(0,s.jsxs)("span",{className:"font-medium text-slate-800",children:[(0,g.xG)(z.vatLow)," – ",(0,g.xG)(z.vatHigh)]})]})]})]}),(0,s.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,s.jsxs)("div",{className:"card-modern p-4 text-center",children:[(0,s.jsx)(o.Z,{className:"w-5 h-5 text-brick-500 mx-auto mb-1"}),(0,s.jsx)("p",{className:"text-lg font-bold text-slate-800",children:_.area_m2.toFixed(1)}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"m\xb2"})]}),(0,s.jsxs)("div",{className:"card-modern p-4 text-center",children:[(0,s.jsx)(d.Z,{className:"w-5 h-5 text-brick-500 mx-auto mb-1"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-slate-800",children:[_.labour_hours_range[0],"–",_.labour_hours_range[1]]}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"hours"})]}),(0,s.jsxs)("div",{className:"card-modern p-4 text-center",children:[(0,s.jsx)(m.Z,{className:"w-5 h-5 text-brick-500 mx-auto mb-1"}),(0,s.jsxs)("p",{className:"text-lg font-bold text-slate-800",children:[_.brick_count_range[0],"–",_.brick_count_range[1]]}),(0,s.jsx)("p",{className:"text-xs text-slate-500",children:"bricks"})]})]}),(0,s.jsxs)("div",{className:"card-modern p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3",children:"Materials Needed"}),(0,s.jsxs)("div",{className:"space-y-3",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-100",children:[(0,s.jsx)("span",{className:"text-slate-600",children:"Bricks"}),(0,s.jsx)("span",{className:"font-semibold text-slate-800",children:(0,g.nS)(_.brick_count_range)})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-slate-100",children:[(0,s.jsx)("span",{className:"text-slate-600",children:"Sand"}),(0,s.jsxs)("span",{className:"font-semibold text-slate-800",children:[(0,g.nS)(_.materials.sand_kg_range)," kg"]})]}),(0,s.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,s.jsx)("span",{className:"text-slate-600",children:"Cement"}),(0,s.jsxs)("span",{className:"font-semibold text-slate-800",children:[(0,g.nS)(_.materials.cement_bags_range)," bags"]})]})]})]}),(null===(e=_.assumptions)||void 0===e?void 0:e.length)>0&&(0,s.jsxs)("div",{className:"card-modern p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3",children:"Assumptions"}),(0,s.jsx)("ul",{className:"space-y-2",children:_.assumptions.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start gap-2 text-sm text-slate-600",children:[(0,s.jsx)(x,{className:"w-4 h-4 text-emerald-500 mt-0.5 flex-shrink-0"}),(0,s.jsx)("span",{children:e})]},t))})]}),(null===(t=_.exclusions)||void 0===t?void 0:t.length)>0&&(0,s.jsxs)("div",{className:"card-modern p-4",children:[(0,s.jsx)("h3",{className:"text-sm font-semibold text-slate-500 uppercase tracking-wide mb-3",children:"Not Included"}),(0,s.jsx)("ul",{className:"space-y-2",children:_.exclusions.map((e,t)=>(0,s.jsxs)("li",{className:"flex items-start gap-2 text-sm text-slate-600",children:[(0,s.jsx)(i,{className:"w-4 h-4 text-amber-500 mt-0.5 flex-shrink-0"}),(0,s.jsx)("span",{children:e})]},t))})]}),(0,s.jsxs)("div",{className:"space-y-3 pt-2",children:[(0,s.jsx)("button",{onClick:B,disabled:N,className:"w-full py-4 px-6 bg-slate-800 text-white rounded-2xl font-semibold flex items-center justify-center gap-2 hover:bg-slate-700 transition-all tap-highlight",children:N?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-white/30 border-t-white rounded-full animate-spin"}),"Generating..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(u.Z,{className:"w-5 h-5"}),"Generate PDF Quote"]})}),(0,s.jsx)("button",{onClick:I,disabled:n||w,className:"w-full py-4 px-6 rounded-2xl font-semibold flex items-center justify-center gap-2 transition-all tap-highlight ".concat(w?"bg-emerald-500 text-white":"bg-slate-100 text-slate-700 hover:bg-slate-200"),children:n?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"w-5 h-5 border-2 border-slate-400 border-t-transparent rounded-full animate-spin"}),"Saving..."]}):w?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x,{className:"w-5 h-5"}),"Saved"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(h.Z,{className:"w-5 h-5"}),"Save Job"]})}),(0,s.jsxs)("button",{onClick:()=>{R(),a.push("/dashboard")},className:"w-full py-4 px-6 btn-gradient text-white rounded-2xl font-semibold flex items-center justify-center gap-2",children:[(0,s.jsx)(p.Z,{className:"w-5 h-5"}),"New Estimate"]})]}),(0,s.jsx)("p",{className:"text-xs text-slate-400 text-center px-4",children:"This is an estimate only. Actual costs may vary based on site conditions, material prices, and scope changes."})]})]})}},4988:function(e,t,a){"use strict";a.d(t,{b:function(){return l}});var s=a(2693),r=a(9378);async function l(e,t){var a,l;let n=await s.PDFDocument.create(),i=n.addPage([595,842]),{height:c}=i.getSize(),o=await n.embedFont(s.StandardFonts.Helvetica),d=await n.embedFont(s.StandardFonts.HelveticaBold),m=c-50,x=(0,s.rgb)(.2,.2,.2),u=(0,s.rgb)(.4,.4,.4),h=(0,s.rgb)(.73,.27,.17);i.drawText("BRICKIE ESTIMATE",{x:50,y:m,size:24,font:d,color:h}),m-=30,t.companyName&&(i.drawText(t.companyName,{x:50,y:m,size:14,font:d,color:x}),m-=18);let p=new Date(e.timestamp).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});for(let t of(i.drawText("Date: ".concat(p),{x:50,y:m,size:10,font:o,color:u}),m-=25,i.drawText("JOB DETAILS",{x:50,y:m,size:12,font:d,color:x}),m-=18,["Job Type: ".concat(e.inputs.jobType),"Anchor Dimension: ".concat(e.inputs.anchorType," = ").concat(e.inputs.anchorValue,"m"),"Difficulty: ".concat(e.inputs.difficulty),"Has Openings: ".concat(e.inputs.hasOpenings?"Yes":"No"),"Estimated Area: ".concat(e.outputs.area_m2.toFixed(1)," m\xb2")]))i.drawText(t,{x:50,y:m,size:10,font:o,color:x}),m-=18;for(let t of(m-=7,i.drawText("ESTIMATED PRICE",{x:50,y:m,size:12,font:d,color:x}),m-=23,i.drawText((0,r.NO)(e.outputs.recommended_price_gbp_range),{x:50,y:m,size:20,font:d,color:h}),m-=25,i.drawText("LABOUR & MATERIALS",{x:50,y:m,size:12,font:d,color:x}),m-=18,["Labour: ".concat((0,r.yS)(e.outputs.labour_hours_range)),"Bricks: ".concat((0,r.nS)(e.outputs.brick_count_range)),"Sand: ".concat((0,r.nS)(e.outputs.materials.sand_kg_range)," kg"),"Cement: ".concat((0,r.nS)(e.outputs.materials.cement_bags_range)," bags")]))i.drawText(t,{x:50,y:m,size:10,font:o,color:x}),m-=18;if(m-=7,(null===(a=e.outputs.assumptions)||void 0===a?void 0:a.length)>0){for(let t of(i.drawText("ASSUMPTIONS",{x:50,y:m,size:12,font:d,color:x}),m-=18,e.outputs.assumptions)){let e="• ".concat(t).substring(0,80);i.drawText(e,{x:50,y:m,size:9,font:o,color:u}),m-=15}m-=7}if((null===(l=e.outputs.exclusions)||void 0===l?void 0:l.length)>0){for(let t of(i.drawText("EXCLUSIONS",{x:50,y:m,size:12,font:d,color:x}),m-=18,e.outputs.exclusions)){let e="• ".concat(t).substring(0,80);i.drawText(e,{x:50,y:m,size:9,font:o,color:u}),m-=15}m-=7}m=Math.max(m,130),i.drawLine({start:{x:50,y:m+10},end:{x:545,y:m+10},thickness:.5,color:(0,s.rgb)(.8,.8,.8)}),m-=10,i.drawText("DISCLAIMER",{x:50,y:m,size:10,font:d,color:u}),m-=15;let b=t.disclaimerText.split(" "),f="";for(let e of b){let t=f+(f?" ":"")+e;o.widthOfTextAtSize(t,8)>495?(i.drawText(f,{x:50,y:m,size:8,font:o,color:u}),m-=12,f=e):f=t}f&&i.drawText(f,{x:50,y:m,size:8,font:o,color:u}),i.drawText("Generated by Brickie App",{x:50,y:40,size:8,font:o,color:(0,s.rgb)(.6,.6,.6)});let g=new Blob([await n.save()],{type:"application/pdf"}),j=URL.createObjectURL(g),y=document.createElement("a");y.href=j,y.download="brickie-estimate-".concat(e.id,".pdf"),document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(j)}},1184:function(e,t,a){"use strict";a.d(t,{o:function(){return s}});let s=(0,a(1447).U)((e,t)=>({user:null,profile:null,isLoading:!0,photoFile:null,photoPreview:null,jobType:"Brickwork",anchorType:"length",anchorValue:"",difficulty:"Standard",hasOpenings:!1,currentResult:null,isEstimating:!1,error:null,jobs:[],pricingMethod:"day_rate",dayRate:"220",ratePer1000:"500",ratePerM2:"65",materialMarkup:"10",includeVAT:!1,setUser:t=>e({user:t}),setProfile:t=>{if(t){var a,s;e({profile:t,dayRate:(null===(a=t.day_rate)||void 0===a?void 0:a.toString())||"220",pricingMethod:t.default_pricing_method||"day_rate",materialMarkup:(null===(s=t.material_markup)||void 0===s?void 0:s.toString())||"10",includeVAT:t.vat_registered||!1})}else e({profile:t})},setLoading:t=>e({isLoading:t}),setPhotoFile:t=>e({photoFile:t}),setPhotoPreview:t=>e({photoPreview:t}),setJobType:t=>e({jobType:t}),setAnchorType:t=>e({anchorType:t}),setAnchorValue:t=>e({anchorValue:t}),setDifficulty:t=>e({difficulty:t}),setHasOpenings:t=>e({hasOpenings:t}),setPricingMethod:t=>e({pricingMethod:t}),setDayRate:t=>e({dayRate:t}),setRatePer1000:t=>e({ratePer1000:t}),setRatePerM2:t=>e({ratePerM2:t}),setMaterialMarkup:t=>e({materialMarkup:t}),setIncludeVAT:t=>e({includeVAT:t}),setCurrentResult:t=>e({currentResult:t}),setEstimating:t=>e({isEstimating:t}),setError:t=>e({error:t}),resetEstimate:()=>e({photoFile:null,photoPreview:null,jobType:"Brickwork",anchorType:"length",anchorValue:"",difficulty:"Standard",hasOpenings:!1,currentResult:null,error:null}),setJobs:t=>e({jobs:t}),addJob:t=>e(e=>({jobs:[t,...e.jobs]})),removeJob:t=>e(e=>({jobs:e.jobs.filter(e=>e.id!==t)})),getInputs:()=>{let{jobType:e,anchorType:a,anchorValue:s,difficulty:r,hasOpenings:l}=t();if(!s)return null;let n=parseFloat(s);return isNaN(n)||n<=0?null:{jobType:e,anchorType:a,anchorValue:n,difficulty:r,hasOpenings:l,pricing:t().getPricingInputs()}},getPricingInputs:()=>{let{pricingMethod:e,dayRate:a,ratePer1000:s,ratePerM2:r,materialMarkup:l,includeVAT:n}=t();return{method:e,dayRate:parseFloat(a)||220,ratePer1000:parseFloat(s)||500,ratePerM2:parseFloat(r)||65,materialMarkup:parseFloat(l)||10,includeVAT:n,vatRate:20}}}))},9250:function(e,t,a){"use strict";a.d(t,{e:function(){return l}});var s=a(2059),r=a(8345);function l(){return(0,s.createBrowserClient)(r.env.NEXT_PUBLIC_SUPABASE_URL,r.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},6435:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(5802).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},3488:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(5802).Z)("Ruler",[["path",{d:"M21.3 15.3a2.4 2.4 0 0 1 0 3.4l-2.6 2.6a2.4 2.4 0 0 1-3.4 0L2.7 8.7a2.41 2.41 0 0 1 0-3.4l2.6-2.6a2.41 2.41 0 0 1 3.4 0Z",key:"icamh8"}],["path",{d:"m14.5 12.5 2-2",key:"inckbg"}],["path",{d:"m11.5 9.5 2-2",key:"fmmyf7"}],["path",{d:"m8.5 6.5 2-2",key:"vc6u1g"}],["path",{d:"m17.5 15.5 2-2",key:"wo5hmg"}]])},1117:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let s=(0,a(5802).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])}},function(e){e.O(0,[59,247,997,378,416,963,744],function(){return e(e.s=6125)}),_N_E=e.O()}]);
(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[372],{6125:function(e,t,s){Promise.resolve().then(s.bind(s,5051))},5051:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return f}});var a=s(6517),n=s(6557),r=s(6815),l=s(104),i=s(1052),o=s(9843),c=s(2338),d=s(1117);/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let m=(0,s(5802).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);var x=s(9115),u=s(1184),h=s(9250),p=s(9378),b=s(4988);function f(){var e,t,s;let f=(0,r.useRouter)(),[w,j]=(0,n.useState)(!1),[y,N]=(0,n.useState)(!1),[g,v]=(0,n.useState)(!1),{currentResult:T,photoFile:_,photoPreview:S,user:k,profile:E,addJob:z,resetEstimate:A,getInputs:P}=(0,u.o)(),C=P();if(!T||!C)return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto text-center py-12",children:[(0,a.jsx)("p",{className:"text-warm-600 mb-4",children:"No estimate results available"}),(0,a.jsx)(x.zx,{onClick:()=>f.push("/dashboard"),children:"Start New Estimate"})]});let L=async()=>{if(k){j(!0);try{let e=(0,h.e)(),t=null;_&&(t=await (0,p.ZH)(e,k.id,_,_.name));let s=await (0,p.Cq)(e,k.id,C,T,t);z(s),v(!0)}catch(e){console.error("Failed to save job:",e)}finally{j(!1)}}},O=async()=>{if(E){N(!0);try{await (0,b.b)({id:"temp-".concat(Date.now()),timestamp:Date.now(),inputs:C,outputs:T,photoUri:S||""},{companyName:E.company_name||"",defaultDayRate:E.day_rate||220,currency:"GBP",disclaimerText:E.disclaimer_text||""})}catch(e){console.error("Failed to generate PDF:",e)}finally{N(!1)}}};return(0,a.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-warm-900 mb-6",children:"Estimate Results"}),(0,a.jsxs)("div",{className:"space-y-6",children:[S&&(0,a.jsx)("img",{src:S,alt:"Job photo",className:"w-full h-48 object-cover rounded-xl"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-warm-900",children:C.jobType}),(0,a.jsxs)("p",{className:"text-warm-600",children:[C.anchorType,": ",C.anchorValue,"m • ",C.difficulty,C.hasOpenings?" • Has openings":""]})]}),(0,a.jsxs)("div",{className:"bg-brick-500 rounded-2xl p-6 text-white",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 opacity-80"}),(0,a.jsx)("span",{className:"text-sm font-medium opacity-80",children:"ESTIMATED PRICE"})]}),(0,a.jsx)("p",{className:"text-3xl font-bold",children:(0,p.NO)(T.recommended_price_gbp_range)})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)(x.Zb,{className:"bg-warm-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 text-warm-600"}),(0,a.jsx)("span",{className:"text-xs font-medium text-warm-600 uppercase",children:"Labour"})]}),(0,a.jsx)("p",{className:"text-lg font-semibold text-warm-900",children:(0,p.yS)(T.labour_hours_range)})]}),(0,a.jsxs)(x.Zb,{className:"bg-warm-100",children:[(0,a.jsx)("span",{className:"text-xs font-medium text-warm-600 uppercase",children:"Area"}),(0,a.jsxs)("p",{className:"text-lg font-semibold text-warm-900",children:[T.area_m2.toFixed(1)," m\xb2"]})]})]}),(0,a.jsx)(x.Zb,{title:"Materials",children:(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between py-2 border-b border-warm-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 text-brick-500"}),(0,a.jsx)("span",{className:"text-warm-700",children:"Bricks"})]}),(0,a.jsx)("span",{className:"font-semibold text-warm-900",children:(0,p.nS)(T.brick_count_range)})]}),(0,a.jsxs)("div",{className:"flex justify-between py-2 border-b border-warm-200",children:[(0,a.jsx)("span",{className:"text-warm-700",children:"Sand"}),(0,a.jsxs)("span",{className:"font-semibold text-warm-900",children:[(0,p.nS)(T.materials.sand_kg_range)," kg"]})]}),(0,a.jsxs)("div",{className:"flex justify-between py-2",children:[(0,a.jsx)("span",{className:"text-warm-700",children:"Cement"}),(0,a.jsxs)("span",{className:"font-semibold text-warm-900",children:[(0,p.nS)(T.materials.cement_bags_range)," bags"]})]}),(null===(e=T.materials.other)||void 0===e?void 0:e.length)>0&&(0,a.jsxs)("div",{className:"pt-2 border-t border-warm-200",children:[(0,a.jsx)("p",{className:"text-sm text-warm-600 mb-1",children:"Other:"}),(0,a.jsx)("ul",{className:"list-disc list-inside text-sm text-warm-700",children:T.materials.other.map((e,t)=>(0,a.jsx)("li",{children:e},t))})]})]})}),(null===(t=T.assumptions)||void 0===t?void 0:t.length)>0&&(0,a.jsx)(x.Zb,{title:"Assumptions",children:(0,a.jsx)("ul",{className:"space-y-2",children:T.assumptions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-brick-500 rounded-full mt-2"}),(0,a.jsx)("span",{className:"text-warm-700",children:e})]},t))})}),(null===(s=T.exclusions)||void 0===s?void 0:s.length)>0&&(0,a.jsx)(x.Zb,{title:"Exclusions",children:(0,a.jsx)("ul",{className:"space-y-2",children:T.exclusions.map((e,t)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)("div",{className:"w-1.5 h-1.5 bg-yellow-500 rounded-full mt-2"}),(0,a.jsx)("span",{className:"text-warm-700",children:e})]},t))})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)(x.zx,{variant:"outline",fullWidth:!0,onClick:O,loading:y,children:[(0,a.jsx)(c.Z,{className:"w-5 h-5 mr-2"}),"Generate PDF"]}),(0,a.jsxs)(x.zx,{variant:"secondary",fullWidth:!0,onClick:L,loading:w,disabled:g,children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),g?"Saved":"Save Job"]}),(0,a.jsxs)(x.zx,{fullWidth:!0,onClick:()=>{A(),f.push("/dashboard")},children:[(0,a.jsx)(m,{className:"w-5 h-5 mr-2"}),"New Estimate"]})]}),(0,a.jsx)("p",{className:"text-xs text-warm-500 text-center",children:"This is an estimate only. Actual costs may vary based on site conditions, material prices, and scope changes."})]})]})}},4988:function(e,t,s){"use strict";s.d(t,{b:function(){return r}});var a=s(2693),n=s(9378);async function r(e,t){var s,r;let l=await a.PDFDocument.create(),i=l.addPage([595,842]),{height:o}=i.getSize(),c=await l.embedFont(a.StandardFonts.Helvetica),d=await l.embedFont(a.StandardFonts.HelveticaBold),m=o-50,x=(0,a.rgb)(.2,.2,.2),u=(0,a.rgb)(.4,.4,.4),h=(0,a.rgb)(.73,.27,.17);i.drawText("BRICKIE ESTIMATE",{x:50,y:m,size:24,font:d,color:h}),m-=30,t.companyName&&(i.drawText(t.companyName,{x:50,y:m,size:14,font:d,color:x}),m-=18);let p=new Date(e.timestamp).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"});for(let t of(i.drawText("Date: ".concat(p),{x:50,y:m,size:10,font:c,color:u}),m-=25,i.drawText("JOB DETAILS",{x:50,y:m,size:12,font:d,color:x}),m-=18,["Job Type: ".concat(e.inputs.jobType),"Anchor Dimension: ".concat(e.inputs.anchorType," = ").concat(e.inputs.anchorValue,"m"),"Difficulty: ".concat(e.inputs.difficulty),"Has Openings: ".concat(e.inputs.hasOpenings?"Yes":"No"),"Estimated Area: ".concat(e.outputs.area_m2.toFixed(1)," m\xb2")]))i.drawText(t,{x:50,y:m,size:10,font:c,color:x}),m-=18;for(let t of(m-=7,i.drawText("ESTIMATED PRICE",{x:50,y:m,size:12,font:d,color:x}),m-=23,i.drawText((0,n.NO)(e.outputs.recommended_price_gbp_range),{x:50,y:m,size:20,font:d,color:h}),m-=25,i.drawText("LABOUR & MATERIALS",{x:50,y:m,size:12,font:d,color:x}),m-=18,["Labour: ".concat((0,n.yS)(e.outputs.labour_hours_range)),"Bricks: ".concat((0,n.nS)(e.outputs.brick_count_range)),"Sand: ".concat((0,n.nS)(e.outputs.materials.sand_kg_range)," kg"),"Cement: ".concat((0,n.nS)(e.outputs.materials.cement_bags_range)," bags")]))i.drawText(t,{x:50,y:m,size:10,font:c,color:x}),m-=18;if(m-=7,(null===(s=e.outputs.assumptions)||void 0===s?void 0:s.length)>0){for(let t of(i.drawText("ASSUMPTIONS",{x:50,y:m,size:12,font:d,color:x}),m-=18,e.outputs.assumptions)){let e="• ".concat(t).substring(0,80);i.drawText(e,{x:50,y:m,size:9,font:c,color:u}),m-=15}m-=7}if((null===(r=e.outputs.exclusions)||void 0===r?void 0:r.length)>0){for(let t of(i.drawText("EXCLUSIONS",{x:50,y:m,size:12,font:d,color:x}),m-=18,e.outputs.exclusions)){let e="• ".concat(t).substring(0,80);i.drawText(e,{x:50,y:m,size:9,font:c,color:u}),m-=15}m-=7}m=Math.max(m,130),i.drawLine({start:{x:50,y:m+10},end:{x:545,y:m+10},thickness:.5,color:(0,a.rgb)(.8,.8,.8)}),m-=10,i.drawText("DISCLAIMER",{x:50,y:m,size:10,font:d,color:u}),m-=15;let b=t.disclaimerText.split(" "),f="";for(let e of b){let t=f+(f?" ":"")+e;c.widthOfTextAtSize(t,8)>495?(i.drawText(f,{x:50,y:m,size:8,font:c,color:u}),m-=12,f=e):f=t}f&&i.drawText(f,{x:50,y:m,size:8,font:c,color:u}),i.drawText("Generated by Brickie App",{x:50,y:40,size:8,font:c,color:(0,a.rgb)(.6,.6,.6)});let w=new Blob([await l.save()],{type:"application/pdf"}),j=URL.createObjectURL(w),y=document.createElement("a");y.href=j,y.download="brickie-estimate-".concat(e.id,".pdf"),document.body.appendChild(y),y.click(),document.body.removeChild(y),URL.revokeObjectURL(j)}},1184:function(e,t,s){"use strict";s.d(t,{o:function(){return a}});let a=(0,s(1447).U)((e,t)=>({user:null,profile:null,isLoading:!0,photoFile:null,photoPreview:null,jobType:"Brickwork",anchorType:"length",anchorValue:"",difficulty:"Standard",hasOpenings:!1,currentResult:null,isEstimating:!1,error:null,jobs:[],setUser:t=>e({user:t}),setProfile:t=>e({profile:t}),setLoading:t=>e({isLoading:t}),setPhotoFile:t=>e({photoFile:t}),setPhotoPreview:t=>e({photoPreview:t}),setJobType:t=>e({jobType:t}),setAnchorType:t=>e({anchorType:t}),setAnchorValue:t=>e({anchorValue:t}),setDifficulty:t=>e({difficulty:t}),setHasOpenings:t=>e({hasOpenings:t}),setCurrentResult:t=>e({currentResult:t}),setEstimating:t=>e({isEstimating:t}),setError:t=>e({error:t}),resetEstimate:()=>e({photoFile:null,photoPreview:null,jobType:"Brickwork",anchorType:"length",anchorValue:"",difficulty:"Standard",hasOpenings:!1,currentResult:null,error:null}),setJobs:t=>e({jobs:t}),addJob:t=>e(e=>({jobs:[t,...e.jobs]})),removeJob:t=>e(e=>({jobs:e.jobs.filter(e=>e.id!==t)})),getInputs:()=>{let{jobType:e,anchorType:s,anchorValue:a,difficulty:n,hasOpenings:r}=t();if(!a)return null;let l=parseFloat(a);return isNaN(l)||l<=0?null:{jobType:e,anchorType:s,anchorValue:l,difficulty:n,hasOpenings:r}}}))},9250:function(e,t,s){"use strict";s.d(t,{e:function(){return r}});var a=s(2059),n=s(8345);function r(){return(0,a.createBrowserClient)(n.env.NEXT_PUBLIC_SUPABASE_URL,n.env.NEXT_PUBLIC_SUPABASE_ANON_KEY)}},1117:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.460.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,s(5802).Z)("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]])}},function(e){e.O(0,[59,269,200,326,416,963,744],function(){return e(e.s=6125)}),_N_E=e.O()}]);